# suika85ergo ビルドガイド

## はじめに
このたびはsuika85ergoをお求めいただきありがとうございます。
このドキュメントでは、このキーボードの組み立てから使用できるようになるまでの一連の流れを解説します。

## 用意するもの

### 同梱物
* プレート類（3種類）
  * メインボード 1枚
    * 部品を半田付けするメインとなる基板です
      ![parts5](https://github.com/suikagiken/suika85ergo/assets/115451678/7288ca0f-aecb-44a8-88b3-5fcdb3be8050)
  * バックプレート 1枚
    * キーボードの一番底になる裏板です
      ![parts4](https://github.com/suikagiken/suika85ergo/assets/115451678/f4f43628-0ce2-4d94-b0ee-43eab971a284)
  * キーマウントプレート 1枚
    * キーボードの一番上にくるプレートです
    * キースイッチをはめ込んで安定させるために使いますが、使用せずに組み立てることも可能です  
      ![parts6](https://github.com/suikagiken/suika85ergo/assets/115451678/a0f4e8f4-fca5-4954-ae5e-f703d22848fc)
* ネジ類（3種類）
  * M2 x 3mm なべ小ねじ 40本（+ 予備1本）  
    ![parts3](https://github.com/suikagiken/suika85ergo/assets/115451678/4f450159-daa8-4755-ae33-474e39e4c00f)
  * M2 x 3.5mm 両めねじ スペーサ 20本（+ 予備1本）  
    ![parts2](https://github.com/suikagiken/suika85ergo/assets/115451678/28b7b318-3006-47e7-9579-eca260626338)
  * M2 x 4mm めねじ/おねじ スペーサ 20本（+ 予備1本）  
    ![parts1](https://github.com/suikagiken/suika85ergo/assets/115451678/48f9c030-a445-4e1c-86ee-d79c04a7c8ae)
* ゴム足
  * お好みでバックプレートに貼り付けてお使いください
    * 高さ 7mm 2個
    * 高さ 2mm 4個  
          ![parts8](https://github.com/suikagiken/suika85ergo/assets/115451678/5f104c71-424b-4f2a-ae61-b6c9097b85f4)
* 表面実装ダイオード
  * 1N4148W 85個（+ 予備1個）  
      ![parts7](https://github.com/suikagiken/suika85ergo/assets/115451678/a05d4ce3-beaa-4b12-826c-c9bc580b822e)
* コントローラボード
  * Elite-C

もし不足する部品等がありましたら Twitter @suikagiken のDMまでご連絡ください

### 別途用意が必要な部品
* キースイッチ 85個
  * Cherry MXスイッチ互換の5ピンまたは3ピンのものが使用可能です。
    * Kailh Chocロープロファイルスイッチのピン形状のスイッチは使えません。
    * ホットスワップ用キーソケットは使えません。
* キーキャップ 85個
  * お選びのキースイッチに対応したキーキャップをご用意ください。いずれのプロファイルも使用可能です。
  * 想定しているサイズと個数は下記の通りですが、大きいキーキャップの代わりに小さいものを使用しても問題ありません。
    * 1u 76個
    * 1.25u 2個
    * 1.5u 7個
* USB Type-C ケーブル
  * 写真にはL字のものが写っていますが、ストレートでも問題なく使えます。

### 必要な工具
このキットには表面実装部品があります。電子工作用として一般的なもので通常は十分ですが、
お持ちでない場合や、お手元の工具が不安な場合、下記にあげたものがお勧めの一例です。いずれも秋月電子通商やアマゾンで購入できます。
* ハンダゴテ
  * 表面実装部品を取り付けるため、できるだけコテ先が細く、温度調節機能の付いたものをお勧めします
    * 白光 FX-600 https://akizukidenshi.com/catalog/g/g114456/
* 糸ハンダ
  * こちらもできるだけ細いものがお勧めです。また、鉛フリーハンダは扱いが難しいため慣れない方にはお勧めしません
    * ヤニ入りハンダ 0.65mm https://akizukidenshi.com/catalog/g/g109556/
* ハンダ吸い取り線
  * 取り付けミスがなければ不要ですが、用意があると安心です
    * ハンダ吸い取り線 3mm https://akizukidenshi.com/catalog/g/g102539/
* 精密ドライバー
  * M2のネジが止められるNo.0のプラスドライバーが必要です
    * 精密ドライバーセット https://akizukidenshi.com/catalog/g/g118343/
* ピンセット
  * 表面実装部品の取り付けに不可欠です。
    * 精密ピンセット https://akizukidenshi.com/catalog/g/g102541/

## 組み立て
このキーボード組み立ての一番の難関は最初の表面実装ダイオードのハンダ付けです。小さいダイオードを多数取り付けますので、落ち着いて慎重に進めて下さい。

### (1) 表面実装ダイオードのハンダ付け 
表面実装ダイオードは1N4148Wを使用しています。下の写真の向きに85個すべてのダイオードをハンダ付けします。  
![diode_polarity](https://github.com/suikagiken/suika85ergo/assets/115451678/a61ad12c-46fa-4927-9681-757ef9c80a93)  
表面実装部品のハンダ付けが初めての方は次の項を参考にしてください。慣れている方はそのまま(2)をご参照ください。  

#### ハンダ付けが初めての方向け
1. パーツをシートから取り出してお皿などに出す  
   * ピンセットで取りやすくするため、適当なお皿などを用意します。
   * 外にこぼさないように注意しながら、お皿にシートから取り出します。黒いトレイを手で持ち、ピンセットで透明シートをはがすようにするとうまく取り出せます。
2. メインボードのランドの片側だけに予備ハンダをする
   * 一度に両方のランドに予備ハンダを盛るのではなく、片足ずつハンダ付けをするのが表面実装パーツの取り付けのコツです。
   * 利き手にハンダごて、反対側の手に糸ハンダを持ちます。
   * ランドの向かって利き手側（ハンダごてを持つ側）に、0.5mm程度の高さに予備ハンダを盛ります。
3. 向きに注意してピンセットでランドにダイオードを置く
   * ピンセットはハンダごてと反対側に持ち、
4. ピンセットで位置を合わせながら片足をハンダ付けする
   * 利き手にハンダごて、反対側の手にピンセットを持ちます。ハンダ線はここでは持ちません。
   * 向きが正しいことを確認したら、ピンセットでダイオードを持ちながら、予備ハンダをしたランドにダイオードの一方の足を合わせます。
   * 足の上からハンダゴテで予備ハンダを溶かし、固定します。
5. もう片足をハンダ付けする
   * 利き手にハンダごて、反対側の手に糸ハンダを持ちます。
   * 上でハンダ付けしていないほうの足をハンダ付けします。
6. 2.～5.を85個分繰り返す
   * これらのダイオードのハンダ付けをひたすら根気よく繰り返します。何よりダイオードの向きには特に注意してください。
   * 「片足ばかりのハンダ付けを繰り返し、そのあともう片足ばかりのハンダ付けを繰り返す」でも構いませんが、その場合は片足のハンダのし忘れに注意してください。

### (2) コントローラボードのハンダ付け
コントローラボードにはKeebio製Elite-Cを使用しています。ハンダ付けにはピンを使わず、Elite-Cのボード端の金メッキ部とランドをブリッジする形で、Type-C端子が外を向くようにハンダ付けします。  
初めての方は次の項を参考にしてください。慣れている方はそのまま(3)をご参照ください。

#### ハンダ付けが初めての方向け
1. ランドの1箇所に予備ハンダをする
   * 利き手にハンダごて、反対側の手に糸ハンダを持ちます。
   * コントローラボードのランドの1か所に,予備ハンダをします。この1か所で位置決めをします。
2. コントローラボードの位置を合わせながら1か所ハンダ付けする
   * 利き手にハンダごてを持ち、反対側の手にコントローラボードを持ち、ランドに合わせます。
   * 予備ハンダを溶かしながら、コントローラボードをが正しい位置に来るようにしてハンダ付けします。
3. 残りのランドをハンダ付けする
  * 利き手にハンダごて、反対側の手に糸ハンダを持ちます。
4. 

### (3) 動作確認
この時点でダイオードとコントローラボードの取り付けができていると思いますが、このコントローラボードはファームウエア書き込み済みのため、スイッチを取り付ける前のこの段階で動作確認が可能です。
1. Type-CケーブルでPCに接続します。しばらくして新しいデバイスとしてPCに認識されることを確認します。
2. ブラウザでQMK Configuratorのキーボードテスト https://config.qmk.fm/#/test を起動します
3. それぞれのキーに相当する端子をピンセットなどでショートして、キー入力として認識するかどうかを確認します
   もしこの時点で反応しない端子がある場合、パーツの取り付けに何らかのミスがあることが考えられます。ダイオードの取り付け向きや、コントロールボードのハンダ不良がないかを確認してください。

### (3) マウントプレートへのネジ・スペーサの取り付け
キーのマウントプレートを使用する際は、まずネジとスペーサを先に取り付けておくとあとの工程が容易です。
1. 表側からM2 x 3mm なべ小ねじをあてがう
2. 裏側からM2 x 3.5mm 両めねじ スペーサを手でねじ込む
3. スペーサを押さえながら、ドライバーで増し締めする
なお、マウントプレートなしで直接メインボードにスイッチをはめてハンダ付けすることも可能です。その場合は位置決めを慎重に行ってください。5ピンのスイッチを使用する場合は比較的容易ですが、3ピンのスイッチの場合、ピンの遊びでキーが揃いにくくなりますのでハンダ付け時に注意が必要です。

### (4) マウントプレートのメインボードへの取り付け
1. マウントプレートのスペーサ側を表にして置き、その上にハンダ面を表にしたメインボードを重ねる
2. 20か所のネジ穴に、M2 x 4mm めねじ/おねじ スペーサをねじ込む。
3. 

### (5) キースイッチの取り付け・ハンダ付け
1. マウントプレートの穴にキースイッチをしっかり奥まで差し込む
2. すべて差し込み終わったら落ちないようにゆっくり裏返してハンダ面を表にする
3. 85個のキースイッチの2ピンずつをハンダ付けする

### (8) バックプレートのネジ止め
1. メインボードのハンダ面を表にして置き、その上に「すいか技研」の文字のプリントを表にしたバックプレートを重ねる
2. 20か所のネジ穴に、M2 x 3mm なべ小ねじをねじ込む。

### (9) ゴム足の取り付け
バックプレートの好きな場所にお好みでゴム足を取り付ける。

### (10) キーキャップの取り付け
最後に、キースイッチにお好みのキーキャップを取り付けて、組み立ては完成です。

## ファームウエアの書き込み
**【通常はこの手順をスキップできます】**  
同梱のコントローラボードにはすでにファームウエアを書き込んであるため、改めてファームウエアを書き込む必要はありません。
もし何らかの理由で誤ってファームウエアを消してしまった場合や、別のコントローラボードを使う場合は次の手順を参考にしてください。

### QMK ToolBoxのインストール
1. https://github.com/qmk/qmk_toolbox/releases からQMK Toolboxをダウンロードし、インストールします。

### suikagiken_suika85ergo_default.hex の書き込み
1. すいか技研のリポジトリ https://github.com/suikagiken/suika85ergo から、ファームウエアのファイルsuikagiken_suika85ergo_default.hex をダウンロードし、適当な場所に保存します。
2. QMK Toolboxを起動し、Openをクリックして数のようにファームウエアファイルを指定します。
3. Elite-Cボードのボタンを押し、ファーム書き込みモードにします。
4. Flashボタンをクリックして書き込みが終わるのを待ちます
5. 下のメッセージが出たら書き込みが完了です。

## キーマップの編集
いよいよ最後の工程です。
### VIA の起動


・キーテスト



## おわりに

